---
tags:
  - SWE
---
## What is `Event Storming` , why we need it

因為一項軟體產品所需要的領域知識往往會是跨團隊的，即便軟體工程師的主要任務是進行開發，但也要對要開發目標的 domain knowledge 有一定的了解才能夠在開發的過程中更加流暢。  

而 Event Storming 就是一個協助建立軟體模型的工作訪，透過這樣的方式來讓大家對商業流程有共同理解，以及整體流程的概覽圖。

## Stage

### Big Picture

**主要目的：**
- 建立對整個業務領域的共同理解
- 識別系統中所有重要的領域事件（Domain Events）
- 發現業務流程的全貌和邊界
- 讓所有參與者（包括技術和業務人員）對問題空間達成共識
- 找出潛在的問題點、瓶頸或混亂區域

**特色：** 這個階段著重在「廣度」而非「深度」，使用橘色便利貼標註所有發生過的事件，按時間順序排列在牆上，形成一個完整的業務流程全景圖。

### Process Modeling 


**主要目的：**
- 深入探索特定的業務流程細節
- 識別觸發事件的命令（Commands）
- 定義處理命令的聚合（Aggregates）或角色
- 釐清業務規則和政策（Policies）
- 發現外部系統的整合點
- 建立更精確的因果關係

**特色：** 這個階段會選擇 Big Picture 中的重要流程進行深入分析，使用更多顏色的便利貼來區分不同元素（藍色命令、黃色聚合、紫色政策等），讓流程的邏輯更加清晰。

### Software Design

**主要目的：**
- 將業務流程轉化為軟體設計
- 定義 Bounded Contexts（限界上下文）
- 識別聚合的邊界和職責
- 設計 API 和服務介面
- 規劃資料模型和持久化策略
- 為實作做準備，產出技術架構藍圖

**特色：** 這個階段更偏向技術實作，會開始討論如何將前兩階段的成果轉換成實際的程式碼結構、微服務邊界、資料庫設計等技術決策。
## Terminology

### 核心元素

#### 1. Domain Event（領域事件）🟧

**顏色：橘色便利貼**

**定義：** 系統中已經發生的重要業務事實，使用過去式動詞描述。

**特徵：**

- 不可改變的事實
- 對業務有意義
- 值得被記錄和追蹤

**範例：**

- 「訂單已建立」
- 「付款已完成」
- 「商品已出貨」

---

#### 2. Command（命令）🟦

**顏色：藍色便利貼**

**定義：** 使用者或系統想要執行的意圖或動作，會觸發業務邏輯並產生 Event。使用祈使句描述。

**特徵：**

- 表達「想做某事」的意圖
- 可能成功或失敗
- 由 Actor 發起

**範例：**

- 「建立訂單」
- 「提交付款」
- 「取消預約」

---

#### 3. Actor（角色/參與者）🟡

**顏色：黃色小人形便利貼**

**定義：** 發起 Command 的人或外部系統。

**類型：**

- **人類角色**：顧客、管理員、操作員等
- **外部系統**：第三方 API、排程系統、其他服務等

**範例：**

- 「顧客」
- 「系統管理員」
- 「支付閘道系統」

---

#### 4. Aggregate（聚合）🟨

**顏色：黃色便利貼**

**定義：** 處理 Command 並產生 Event 的業務實體或概念，代表一組相關資料和行為的邊界。

**特徵：**

- 負責執行業務邏輯
- 維護資料一致性
- 是交易邊界

**範例：**

- 「訂單」
- 「購物車」
- 「庫存」
- 「會員帳戶」

---

#### 5. Policy（政策/業務規則）🟪

**顏色：紫色/淡紫色便利貼**

**定義：** 當某個 Event 發生後，自動觸發另一個 Command 的業務規則，通常用「當...時...」的句式表達。

**特徵：**

- 反應式邏輯
- 連接不同的業務流程
- 可能跨越不同的 Bounded Context

**範例：**

- 「當付款完成時，發送確認郵件」
- 「當庫存低於安全值時，自動補貨」
- 「當訂單取消時，退回庫存」

---

### 輔助元素

#### 6. Read Model / Query（讀取模型/查詢）🟩

**顏色：綠色便利貼**

**定義：** 使用者或系統需要讀取的資訊或畫面，通常不會改變系統狀態。

**範例：**

- 「訂單列表頁面」
- 「庫存查詢」
- 「會員資料檢視」

---

#### 7. External System（外部系統）🟦

**顏色：粉紅色便利貼**

**定義：** 與主系統互動的第三方系統或服務。

**範例：**

- 「金流服務」
- 「物流追蹤系統」
- 「簡訊發送服務」

---

#### 8. Hot Spot（問題點/爭議點）🔴

**顏色：紅色或粉紅色便利貼**

**定義：** 討論中發現的問題、疑問、風險或需要進一步釐清的地方。

**用途：**

- 標記不確定的業務規則
- 記錄技術風險
- 提醒需要後續討論的議題

**範例：**

- 「付款失敗後的重試機制尚未定義」
- 「跨國訂單的稅務計算邏輯不明確」

---

#### 9. Bounded Context（限界上下文）

**表示方式：用線條或區域劃分**

**定義：** 一個明確的邊界，在此邊界內，特定的業務術語和模型具有一致的含義。這是 DDD（領域驅動設計）的核心概念。

**用途：**

- 在 Software Design 階段定義
- 劃分微服務或模組邊界
- 定義團隊職責範圍

**範例：**

- 「訂單管理上下文」
- 「庫存管理上下文」
- 「會員管理上下文」

---

#### 10. User Interface / Screen（使用者介面）

**顏色：白色便利貼或手繪**

**定義：** 使用者與系統互動的介面或畫面。

**範例：**

- 「結帳頁面」
- 「商品詳情頁」

---

## 元素之間的關係流程

```
Actor → Command → Aggregate → Event → Policy → Command → ...
              ↓                    ↓
         Read Model          Hot Spot (可能出現)
              ↓
    External System (可能涉及)
```

---

## 便利貼顏色快速參考

|元素|顏色|說明|
|---|---|---|
|Domain Event|🟧 橘色|已發生的事實|
|Command|🟦 藍色|想執行的動作|
|Actor|🟡 黃色小人|發起者|
|Aggregate|🟨 黃色|處理邏輯的實體|
|Policy|🟪 紫色|自動化規則|
|Read Model|🟩 綠色|查詢資訊|
|External System|🩷 粉紅色|外部系統|
|Hot Spot|🔴 紅色|問題或疑問|

這些元素會根據不同階段逐步加入，從 Big Picture 的簡單 Events，到 Process Modeling 的完整元素，最後在 Software Design 階段整合成系統架構。

## Summary

整個 Event Storming 的討論流程主要是透過「**尋找 Event（領域事件）**」出發，這些 Event 代表系統中已經發生的事實。

接著，團隊會為每個 Event 識別其相關元素：

- **Command（命令）**：觸發 Event 的意圖或動作
- **Actor（角色）**：發起 Command 的人或系統
- **Aggregate（聚合）**：處理 Command 並產生 Event 的業務實體
- **Policy（政策）**：當某個 Event 發生後，自動觸發下一個 Command 的業務規則

整體的因果流程是：**Actor 發起 Command → Aggregate 處理 → 產生 Event → Policy（可選）觸發下一個 Command**

前兩個階段（Big Picture 和 Process Modeling）主要聚焦在**業務邏輯的探索和釐清**，建立團隊對領域的共同理解。

最後一個階段（Software Design）則是依照前兩階段討論出來的結果，進行**架構設計和技術轉化**，包括：

- 定義 Bounded Context（限界上下文）
- 劃分服務邊界
- 設計 API 或 Interface
- 規劃資料模型和系統架構

這個階段不只是單純的轉換，而是重新組織和架構化業務知識，使其成為可實作的軟體設計。

---

這個版本應該更適合放入你的筆記中！

## Reference

[Event Storming Part 3 - 軟體設計 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10220315)